<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>ğŸ° BelekÂ´s Slot-Maschine</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
html,body{margin:0;padding:0;height:100%;background:#111;color:white;font-family:Arial}
#layout{display:flex;height:100vh;overflow:hidden}
#app{width:55%;display:flex;justify-content:center;align-items:center}
#gameCard{background:linear-gradient(180deg,#111,#000);border:3px solid gold;border-radius:20px;
padding:28px 34px;box-shadow:0 0 30px rgba(255,215,0,.25);display:flex;flex-direction:column;
align-items:center;gap:14px;min-width:420px}
h1{color:gold;font-size:2.6rem;text-shadow:0 0 12px gold}
.status{color:cyan}
.jackpot{color:gold;font-size:1.9rem;text-shadow:0 0 12px gold}
.reels{display:flex;gap:25px;margin:18px 0}
.reel{width:95px;font-size:4.5rem;background:#000;padding:18px;border:5px ridge gold;text-align:center}
.controls{display:flex;gap:10px}
.controls button{padding:12px 18px;font-size:1.05rem;min-width:130px;border:none;border-radius:10px;cursor:pointer}
.spin{background:green;color:white}
.allin{background:red;color:white}
.player-info{font-size:1.25rem;color:cyan}
#right{width:45%;background:black;border-left:4px solid gold;padding:12px;display:flex;flex-direction:column;gap:12px}
.panel{background:linear-gradient(180deg,#111,#000);border:2px solid gold;border-radius:12px;padding:10px}
.panel h3{text-align:center;color:gold}
#leaderboardList{min-height:450px;max-height:450px;overflow-y:auto}
#leaderboardList div{display:flex;justify-content:space-between;padding:6px;border-bottom:1px solid #333}
.lb-1{color:gold}.lb-2{color:silver}.lb-3{color:#cd7f32}.lb-self{border-left:3px solid cyan}
#winLog{min-height:260px;max-height:260px;overflow-y:auto}
.log-win{color:#00ff7f}.log-lose{color:#ff4c4c}.log-jackpot{color:gold}
 
#paytable table{width:100%;border-collapse:collapse}
#paytable th,#paytable td{text-align:center;padding:6px}
#paytable th{color:gold;border-bottom:1px solid gold}
#paytable tr:not(:last-child) td{border-bottom:1px solid rgba(255,215,0,.25)}
 
</style>
</head>

<body>
<div id="layout">
<div id="app">
<div id="gameCard">
<h1>ğŸ° BelekÂ´s Slot-Maschine ğŸ°</h1>
<div id="status" class="status"></div>
<div id="jackpot" class="jackpot"></div>
<div id="timer" class="status"></div>

<div class="reels">
<div class="reel" id="r1">â”</div>
<div class="reel" id="r2">â”</div>
<div class="reel" id="r3">â”</div>
</div>

<div class="controls">
<button onclick="setBet()">ğŸ¯ Einsatz</button>
<button class="allin" onclick="allIn()">ğŸ’¥ ALL IN</button>
<button class="spin" onclick="spin()">â–¶ SPIN</button>
</div>

<div id="playerInfo" class="player-info"></div>
</div>
</div>

<div id="right">
<div class="panel"><h3>ğŸ† Leaderboard</h3><div id="leaderboardList"></div></div>
<div class="panel"><h3>ğŸ§¾ Gewinne</h3><div id="winLog"></div></div>

 <div class="panel" id="paytable">
<h3>ğŸ“Š Paytable</h3>
<table>
<tr><th>Kombi</th><th>x</th></tr>
<tr><td>ğŸ’ğŸ’ğŸ’</td><td>10</td></tr>
<tr><td>ğŸ‹ğŸ‹ğŸ‹</td><td>30</td></tr>
<tr><td>ğŸŠğŸŠğŸŠ</td><td>50</td></tr>
<tr><td>ğŸ””ğŸ””ğŸ””</td><td>75</td></tr>
<tr><td>â­â­â­</td><td>100</td></tr>
<tr><td>7ï¸âƒ£7ï¸âƒ£7ï¸âƒ£</td><td>150</td></tr>
<tr><td>ğŸ’ğŸ’ğŸ’</td><td>JACKPOT</td></tr>
</table>
</div>
</div>
</div>

<script>
firebase.initializeApp({
 apiKey:"AIzaSyBqJub5JZstuXNlemSLc9HFziEs11gA70k",
 authDomain:"slot-site-dce13.firebaseapp.com",
 projectId:"slot-site-dce13"
});
const db=firebase.firestore();
 
const winLogEl = document.getElementById("winLog");

const jackpotRef=db.collection("game").doc("jackpot");

const SYMBOLS=["ğŸ’","ğŸ‹","ğŸŠ","ğŸ””","â­","7ï¸âƒ£","ğŸ’"];
const PAYTABLE={"ğŸ’":10,"ğŸ‹":30,"ğŸŠ":50,"ğŸ””":75,"â­":100,"7ï¸âƒ£":150};

const INCOME_PER_MIN=50,INTERVAL=60000;

let playerName=localStorage.getItem("player_name")||prompt("Spielername:");
localStorage.setItem("player_name",playerName);

let data={balance:5000,bet:50,lastIncome:Date.now()};
let jackpotValue=5000,spinning=false;
let winLog=[];

/* ===== INITIAL LOAD ===== */
async function init(){
 const jp=await jackpotRef.get();
 if(jp.exists) jackpotValue=jp.data().value;
 const ref=db.collection("players").doc(playerName);
 const d=await ref.get();
 if(d.exists)data={...data,...d.data()};
 else await ref.set(data);
 updateUI();
 loadLeaderboard();
}
init();

/* ===== LEADERBOARD (ALLE 5s) ===== */
async function loadLeaderboard(){
 const snap=await db.collection("players").orderBy("balance","desc").limit(10).get();
 leaderboardList.innerHTML="";
 let i=1;
 snap.forEach(d=>{
  let c=i==1?"lb-1":i==2?"lb-2":i==3?"lb-3":"";
  if(d.id===playerName)c+=" lb-self";
  leaderboardList.innerHTML+=`<div class="${c}"><span>${i}. ${d.id}</span><span>${d.data().balance} â‚¬</span></div>`;
  i++;
 });
}
setInterval(loadLeaderboard,5000);

/* ===== EINKOMMEN (LOKAL) ===== */
setInterval(()=>{
 const now=Date.now();
 if(data.balance<5000){
  const diff=Math.floor((now-data.lastIncome)/INTERVAL);
  if(diff>0){
   data.balance=Math.min(5000,data.balance+diff*INCOME_PER_MIN);
   data.lastIncome+=diff*INTERVAL;
   savePlayer();
  }
  timer.innerText=`â³ +50â‚¬ in ${Math.ceil((INTERVAL-(now-data.lastIncome))/1000)}s`;
 }else timer.innerText="âœ… Maximales Einkommen erreicht";
 updateUI();
},1000);

/* ===== SPIN ===== */
function randomSym(){return SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)]}
async function spin(){
 if(spinning) return;
 if(data.balance < data.bet){
  alert("âŒ Nicht genug Guthaben");
  return;
 }

 spinning = true;

 try{
  data.balance -= data.bet;
  jackpotValue += data.bet;

  await jackpotRef.set({value: jackpotValue});

  const f1=randomSym(), f2=randomSym(), f3=randomSym();
  animate(r1,f1,600);
  animate(r2,f2,800);
  animate(r3,f3,1000);

  setTimeout(async()=>{
   if(f1===f2 && f2===f3){
    if(f1==="ğŸ’"){
     const win = jackpotValue;
     data.balance += win;
     jackpotValue = 5000;
     await jackpotRef.set({value: jackpotValue});
     log(`ğŸ’ JACKPOT +${win}â‚¬`, "jackpot");
    } else {
     const win = data.bet * PAYTABLE[f1];
     data.balance += win;
     log(`ğŸ‰ Gewinn +${win}â‚¬`, "win");
    }
   } else {
    log("âŒ Kein Gewinn", "lose");
   }

   await savePlayer();
   updateUI();
   spinning = false;
  },1100);

 } catch(e){
  console.error(e);
  spinning = false;
 }
}


/* ===== UTIL ===== */
function animate(reel,sym,d){
 const s=Date.now();
 const i=setInterval(()=>{
  reel.innerText=randomSym();
  if(Date.now()-s>=d){clearInterval(i);reel.innerText=sym;}
 },70);
}
function log(text, type){
 let cls = "log-win";
 if(type==="lose") cls="log-lose";
 if(type==="jackpot") cls="log-jackpot";

 winLog.unshift(`<div class="log-entry ${cls}">${text}</div>`);
 winLog = winLog.slice(0,12);
 winLogEl.innerHTML = winLog.join("");
}
function updateUI(){
 status.innerText=`ğŸ‘¤ ${playerName}`;
 jackpot.innerText=`ğŸ’ JACKPOT: ${jackpotValue} â‚¬`;
 playerInfo.innerText=`ğŸ’° ${data.balance} â‚¬ | ğŸ¯ Einsatz ${data.bet} â‚¬`;
}
function setBet(){
 const v=parseInt(prompt("Einsatz:",data.bet));
 if(v>=50&&v<=data.balance)data.bet=v;
}
function allIn(){
 if(data.balance<50)return alert("âŒ Kein Guthaben");
 data.bet=data.balance;
}
async function savePlayer(){
 await db.collection("players")
 .doc(playerName)
 .set(data,{merge:true});
}

</script>
</body>
</html>





